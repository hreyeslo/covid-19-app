<div class="c-dashboard">

    <div class="c-dashboard__header" fxLayout="column">
        <div fxLayout="row" fxLayoutAlign="center center">
            <mat-icon class="c-dashboard__header__icon">language</mat-icon>
            <span class="c-dashboard__header__title">{{'title' | translate}}</span>
        </div>
        <div fxLayout="row" fxLayoutAlign="center center" class="c-dashboard__header__date">
            <span>{{'lastUpdate' | translate}}</span>
            <span class="c-dashboard__header__date__value">{{lastUpdate$ | async | date:'d-M-yyyy, HH:mm z'}}</span>
        </div>
    </div>

    <div class="c-dashboard__container" *ngIf="viewData$ | async; let viewData; else spinner">
        <mat-tab-group class="c-dashboard__container__tabs" [dynamicHeight]="true">
            <mat-tab label="{{'tabs.summary' | translate}}">
                <div class="c-dashboard__container__cards" fxLayout="row wrap" fxLayoutAlign="flex-start flex-start">
                    <mat-card
                        class="c-dashboard__container__cards__card"
                        *ngFor="let card of viewData?.cards; trackBy: trackByIndex"
                        fxFlex.xs="100"
                        [fxFlex.sm]="'0 1 calc(50% - 20px)'"
                        [fxFlex.md]="'0 1 calc(50% - 40px)'"
                        [fxFlex]="'0 1 calc(25% - 40px)'"
                    >
                        <mat-card-header class="c-dashboard__container__cards__card__header">
                            <mat-card-title class="c-dashboard__container__cards__card__header__title">{{ 'cards.' + card?.title | translate}}</mat-card-title>
                        </mat-card-header>
                        <mat-card-content class="c-dashboard__container__cards__card__content">
                            <span class="c-dashboard__container__cards__card__content__value" [countUp]="card?.value" [options]="countUpOptions" [reanimateOnClick]="false"></span>
                        </mat-card-content>
                    </mat-card>
                </div>
            </mat-tab>
            <mat-tab label="{{'tabs.charts' | translate}}">
                <covid-charts [global]="viewData.global" [historical]="viewData.historical"></covid-charts>
            </mat-tab>
        </mat-tab-group>
    </div>

</div>

<ng-template #spinner>
    <div class="spinner">
        <mat-progress-spinner class="example-margin" color="accent" mode="indeterminate"></mat-progress-spinner>
    </div>
</ng-template>
